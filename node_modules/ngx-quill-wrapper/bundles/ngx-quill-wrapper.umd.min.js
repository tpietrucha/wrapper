(function(global,factory){typeof exports==="object"&&typeof module!=="undefined"?factory(exports,require("@angular/core"),require("quill"),require("@angular/common")):typeof define==="function"&&define.amd?define(["exports","@angular/core","quill","@angular/common"],factory):(global=global||self,factory((global.zef=global.zef||{},global.zef.ngxQuillWrapper={}),global.ng.core,global.Quill,global.ng.common))})(this,function(exports,core,Quill,common){"use strict";Quill=Quill&&Quill.hasOwnProperty("default")?Quill["default"]:Quill;var QuillService=function(){function QuillService(){this.toolbar=null}QuillService.prototype.getToolbar=function(toolbarConfig){var toolbar=toolbarConfig;if(typeof toolbarConfig==="string"){toolbar=document.querySelector(toolbarConfig)}if(typeof HTMLElement!=="undefined"&&toolbar instanceof HTMLElement){if(!this.toolbar){this.toolbar=toolbar}var clone=this.toolbar.cloneNode(true);if(toolbar.parentNode){toolbar.parentNode.replaceChild(clone,toolbar)}return clone}return toolbarConfig};QuillService.decorators=[{type:core.Injectable}];QuillService.ctorParameters=function(){return[]};return QuillService}();var QUILL_CONFIG=new core.InjectionToken("QUILL_CONFIG");var QuillConfig=function(){function QuillConfig(config){if(config===void 0){config={}}this.assign(config)}QuillConfig.prototype.assign=function(config,target){if(config===void 0){config={}}target=target||this;for(var key in config){if(config[key]!=null&&!Array.isArray(config[key])&&typeof config[key]==="object"&&(typeof HTMLElement==="undefined"||!(config[key]instanceof HTMLElement))){target[key]={};this.assign(config[key],target[key])}else{target[key]=config[key]}}};return QuillConfig}();var QuillDirective=function(){function QuillDirective(zone,elementRef,differs,service,defaults){this.zone=zone;this.elementRef=elementRef;this.differs=differs;this.service=service;this.defaults=defaults;this.instance=null;this.selection=null;this.hasFocus=false;this.showToolbar=false;this.configDiff=null;this.defaultToolbarConfig=[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",false,"large","huge"]}],[{header:[1,2,3,4,5,6,false]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"]];this.disabled=false;this.autoToolbar=false;this.realToolbar=false;this.blur=new core.EventEmitter;this.focus=new core.EventEmitter;this.editorCreate=new core.EventEmitter;this.contentChange=new core.EventEmitter;this.selectionChange=new core.EventEmitter}QuillDirective.prototype.ngOnInit=function(){var _this=this;var params=new QuillConfig(this.defaults);params.assign(this.config);if(this.disabled){params.readOnly=true;params.modules={toolbar:false}}else{params.theme=params.theme||"snow";params.modules=params.modules||{toolbar:true};params.modules.toolbar=params.modules.toolbar||false;if(params.modules.toolbar){if(typeof params.modules.toolbar!=="object"||params.modules.toolbar.container===undefined){params.modules.toolbar={container:params.modules.toolbar===true?this.defaultToolbarConfig:params.modules.toolbar}}if(this.autoToolbar&&!this.showToolbar){params.modules.toolbar=false}else if(this.autoToolbar||!this.realToolbar){var toolbar_1=params.modules.toolbar.container;params.modules.toolbar.container=this.service.getToolbar(toolbar_1)}}}this.zone.runOutsideAngular(function(){if(_this.modules){Object.keys(_this.modules).forEach(function(path){if(_this.modules&&_this.modules[path]){Quill.register(path,_this.modules[path])}})}_this.instance=new Quill(_this.elementRef.nativeElement,params);if(!params.readOnly){_this.instance.enable()}else{_this.instance.disable()}if(_this.editorCreate.observers.length){_this.editorCreate.emit(_this.instance)}});if(this.instance&&this.selection&&this.hasFocus===true){this.instance.setSelection(this.selection,"silent");this.instance.focus()}if(this.instance){this.instance.on("text-change",function(delta,oldDelta,source){var html=_this.elementRef.nativeElement.children[0].innerHTML;_this.zone.runOutsideAngular(function(){if(_this.instance&&_this.contentChange.observers.length){_this.contentChange.emit({editor:_this.instance,html:html==="<p><br></p>"?null:html,text:_this.instance.getText(),delta:delta,oldDelta:oldDelta,source:source})}})});this.instance.on("selection-change",function(range,oldRange,source){var resetToolbar=false;if(!range&&_this.hasFocus){_this.hasFocus=false;_this.blur.emit(_this.instance);if(_this.autoToolbar&&_this.showToolbar){_this.showToolbar=false}}else if(range&&!_this.hasFocus){_this.hasFocus=true;_this.focus.emit(_this.instance);if(_this.autoToolbar&&!_this.showToolbar){resetToolbar=true;_this.showToolbar=true}}else{_this.zone.runOutsideAngular(function(){if(_this.instance&&_this.selectionChange.observers.length){_this.selectionChange.emit({editor:_this.instance,range:range,oldRange:oldRange,source:source})}})}if(resetToolbar){setTimeout(function(){_this.ngOnDestroy();_this.ngOnInit()},0)}})}if(!this.configDiff){this.configDiff=this.differs.find(this.config||{}).create();this.configDiff.diff(this.config||{})}};QuillDirective.prototype.ngOnDestroy=function(){if(this.instance){var toolbar_2=this.instance.getModule("toolbar");this.selection=this.instance.getSelection();if(typeof HTMLElement!=="undefined"&&toolbar_2&&toolbar_2.options&&toolbar_2.container&&!(toolbar_2.options.container instanceof HTMLElement)){toolbar_2.container.remove()}if(this.elementRef&&this.elementRef.nativeElement){var preview=this.elementRef.nativeElement.querySelector(".ql-preview");if(preview){preview.innerHTML=""}}delete this.instance;this.instance=null}};QuillDirective.prototype.ngDoCheck=function(){if(this.configDiff){var changes=this.configDiff.diff(this.config||{});if(changes){this.ngOnDestroy();this.ngOnInit()}}};QuillDirective.prototype.ngOnChanges=function(changes){var _this=this;if(this.instance&&changes["disabled"]){if(changes["disabled"].currentValue!==changes["disabled"].previousValue){this.zone.runOutsideAngular(function(){_this.ngOnDestroy();_this.ngOnInit()})}}};QuillDirective.prototype.quill=function(){return this.instance};QuillDirective.prototype.clear=function(source){if(this.instance){this.instance.deleteText(0,this.instance.getLength(),source)}};QuillDirective.prototype.getValue=function(){if(this.instance){return this.instance.getText()}};QuillDirective.prototype.setValue=function(value,source){if(this.instance){this.clear(source);this.instance.clipboard.dangerouslyPasteHTML(value,source);this.instance.setSelection(this.instance.getLength(),1)}};QuillDirective.decorators=[{type:core.Directive,args:[{selector:"[quill]",exportAs:"ngxQuill"}]}];QuillDirective.ctorParameters=function(){return[{type:core.NgZone},{type:core.ElementRef},{type:core.KeyValueDiffers},{type:QuillService},{type:undefined,decorators:[{type:core.Optional},{type:core.Inject,args:[QUILL_CONFIG]}]}]};QuillDirective.propDecorators={disabled:[{type:core.Input}],autoToolbar:[{type:core.Input}],realToolbar:[{type:core.Input}],config:[{type:core.Input,args:["quill"]}],modules:[{type:core.Input,args:["modules"]}],blur:[{type:core.Output}],focus:[{type:core.Output}],editorCreate:[{type:core.Output}],contentChange:[{type:core.Output}],selectionChange:[{type:core.Output}]};return QuillDirective}();var QuillComponent=function(){function QuillComponent(){this.content=null;this.disabled=false;this.autoToolbar=false;this.realToolbar=false;this.useQuillClass=true;this.blur=new core.EventEmitter;this.focus=new core.EventEmitter;this.valueChange=new core.EventEmitter;this.editorCreate=new core.EventEmitter;this.contentChange=new core.EventEmitter;this.selectionChange=new core.EventEmitter}Object.defineProperty(QuillComponent.prototype,"value",{set:function(value){this.setContent(value)},enumerable:true,configurable:true});QuillComponent.prototype.ngAfterViewInit=function(){if(this.content!=null){this.setContent(this.content,true)}};QuillComponent.prototype.setContent=function(value,force){if(force||value!==this.content){if(this.directiveRef){this.directiveRef.setValue(value,"silent")}this.content=value}};QuillComponent.prototype.onContentChange=function(event){this.content=event.html;this.contentChange.emit(event);this.valueChange.emit(event.html)};QuillComponent.decorators=[{type:core.Component,args:[{selector:"quill",exportAs:"ngxQuill",template:'<div [quill]="config" [modules]="modules" [disabled]="disabled" [autoToolbar]="autoToolbar" [realToolbar]="realToolbar" (blur)="blur.emit($event)" (focus)="focus.emit($event)" (editorCreate)="editorCreate.emit($event)" (contentChange)="onContentChange($event)" (selectionChange)="selectionChange.emit($event)">\n  <ng-content select="[quillToolbar]"></ng-content>\n\n  <ng-content select="[quillContent]"></ng-content>\n</div>\n',encapsulation:core.ViewEncapsulation.None,styles:["@import url('https://cdn.quilljs.com/1.3.5/quill.snow.css');\n@import url('https://cdn.quilljs.com/1.3.5/quill.bubble.css');\n\n.quill {\n  display: block;\n  width: 100%;\n  height: 100%;\n}\n\n.quill > .ql-toolbar > .ql-formats {\n  margin-right: 12px;\n  margin-left: 0;\n}\n\n.quill > .ql-toolbar + .ql-container {\n  height: calc(100% - 42px);\n}\n\n.quill[fxflex] {\n  display: flex;\n  flex-direction: inherit;\n  align-items: inherit;\n  min-width: 0;\n  min-height: 0;\n\n  -webkit-box-direction: inherit;\n  -webkit-box-orient: inherit;\n}\n\n.quill[fxflex] > .ql-toolbar {\n  flex: 0 0 auto;\n\n  -webkit-box-flex: 0;\n}\n\n.quill[fxflex] > .ql-container {\n  flex: 1 1 auto;\n  min-width: 0;\n  min-height: 0;\n\n  -webkit-box-flex: 1;\n}\n"]}]}];QuillComponent.ctorParameters=function(){return[]};QuillComponent.propDecorators={value:[{type:core.Input}],disabled:[{type:core.Input}],autoToolbar:[{type:core.Input}],realToolbar:[{type:core.Input}],config:[{type:core.Input}],modules:[{type:core.Input}],useQuillClass:[{type:core.HostBinding,args:["class.quill"]},{type:core.Input}],blur:[{type:core.Output}],focus:[{type:core.Output}],valueChange:[{type:core.Output}],editorCreate:[{type:core.Output}],contentChange:[{type:core.Output}],selectionChange:[{type:core.Output}],directiveRef:[{type:core.ViewChild,args:[QuillDirective]}]};return QuillComponent}();var QuillModule=function(){function QuillModule(){}QuillModule.decorators=[{type:core.NgModule,args:[{declarations:[QuillComponent,QuillDirective],imports:[common.CommonModule],exports:[common.CommonModule,QuillComponent,QuillDirective],providers:[QuillService]}]}];return QuillModule}();exports.QuillComponent=QuillComponent;exports.QuillDirective=QuillDirective;exports.QUILL_CONFIG=QUILL_CONFIG;exports.QuillConfig=QuillConfig;exports.QuillModule=QuillModule;exports.QuillService=QuillService;Object.defineProperty(exports,"__esModule",{value:true})});