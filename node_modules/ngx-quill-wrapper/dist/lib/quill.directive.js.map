{"version":3,"file":"quill.directive.js","sourceRoot":"","sources":["../../src/lib/quill.directive.ts"],"names":[],"mappings":"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","sourcesContent":["import Quill from 'quill';\n\nimport { Quill as QuillInstance } from 'quill';\nimport { Sources as QuillSources } from 'quill';\nimport { RangeStatic as QuillRangeStatic } from 'quill';\n\nimport { Directive, Optional, Inject,\n  OnInit, DoCheck, OnDestroy, OnChanges,\n  Input, Output, EventEmitter, NgZone, ElementRef,\n  KeyValueDiffer, KeyValueDiffers, SimpleChanges } from '@angular/core';\n\nimport { QuillService } from './quill.service';\n\nimport { QUILL_CONFIG, QuillConfig, QuillConfigInterface,\n  QuillModulesInterface } from './quill.interfaces';\n\n@Directive({\n  selector: '[quill]',\n  exportAs: 'ngxQuill'\n})\nexport class QuillDirective implements OnInit, DoCheck, OnDestroy, OnChanges {\n  private instance: QuillInstance | null = null;\n\n  private selection: QuillRangeStatic | null = null;\n\n  private hasFocus: boolean = false;\n  private showToolbar: boolean = false;\n\n  private configDiff: KeyValueDiffer<string, any> | null = null;\n\n  private defaultToolbarConfig: any = [\n    ['bold', 'italic', 'underline', 'strike'],\n    ['blockquote', 'code-block'],\n\n    [{ 'header': 1 }, { 'header': 2 }],\n    [{ 'list': 'ordered'}, { 'list': 'bullet' }],\n    [{ 'script': 'sub'}, { 'script': 'super' }],\n    [{ 'indent': '-1'}, { 'indent': '+1' }],\n    [{ 'direction': 'rtl' }],\n\n    [{ 'size': ['small', false, 'large', 'huge'] }],\n    [{ 'header': [1, 2, 3, 4, 5, 6, false] }],\n\n    [{ 'color': [] }, { 'background': [] }],\n    [{ 'font': [] }],\n    [{ 'align': [] }],\n\n    ['clean']\n  ];\n\n  @Input() disabled: boolean = false;\n\n  @Input() autoToolbar: boolean = false;\n  @Input() realToolbar: boolean = false;\n\n  @Input('quill') config?: QuillConfigInterface;\n\n  @Input('modules') modules?: QuillModulesInterface;\n\n  @Output() blur = new EventEmitter<any>();\n  @Output() focus = new EventEmitter<any>();\n\n  @Output() editorCreate = new EventEmitter<any>();\n  @Output() contentChange = new EventEmitter<any>();\n  @Output() selectionChange = new EventEmitter<any>();\n\n  constructor(private zone: NgZone, private elementRef: ElementRef,\n    private differs: KeyValueDiffers, private service: QuillService,\n    @Optional() @Inject(QUILL_CONFIG) private defaults: QuillConfigInterface) {}\n\n  ngOnInit(): void {\n    const params = new QuillConfig(this.defaults);\n\n    params.assign(this.config); // Custom configuration\n\n    if (this.disabled) {\n      params.readOnly = true;\n\n      params.modules = { toolbar: false }; // Disable toolbar\n    } else {\n      params.theme = params.theme || 'snow';\n\n      params.modules = params.modules || { toolbar: true };\n\n      params.modules.toolbar = params.modules.toolbar || false;\n\n      if (params.modules.toolbar) {\n        if (typeof params.modules.toolbar !== 'object' ||\n           params.modules.toolbar.container === undefined)\n        {\n          params.modules.toolbar = {\n            container: (params.modules.toolbar === true) ?\n              this.defaultToolbarConfig : params.modules.toolbar\n          };\n        }\n\n        if (this.autoToolbar && !this.showToolbar) {\n          params.modules.toolbar = false;\n        } else if (this.autoToolbar || !this.realToolbar) {\n          const toolbar = params.modules.toolbar.container;\n\n          params.modules.toolbar.container = this.service.getToolbar(toolbar);\n        }\n      }\n    }\n\n    this.zone.runOutsideAngular(() => {\n      if (this.modules) {\n        Object.keys(this.modules).forEach((path: string) => {\n          if (this.modules && this.modules[path]) {\n            Quill.register(path, this.modules[path]);\n          }\n        });\n      }\n\n      this.instance = new Quill(this.elementRef.nativeElement, params);\n\n      if (!params.readOnly) {\n        this.instance.enable();\n      } else {\n        this.instance.disable();\n      }\n\n      if (this.editorCreate.observers.length) {\n        this.editorCreate.emit(this.instance);\n      }\n    });\n\n    // Reset selection after onDestroy if available\n\n    if (this.instance && this.selection && this.hasFocus === true) {\n      this.instance.setSelection(this.selection, 'silent');\n\n      this.instance.focus();\n    }\n\n    if (this.instance) {\n      // Add handling of text / content change events\n\n      this.instance.on('text-change', (delta: any, oldDelta: any, source: string) => {\n        const html = this.elementRef.nativeElement.children[0].innerHTML;\n\n        this.zone.runOutsideAngular(() => {\n          if (this.instance && this.contentChange.observers.length) {\n            this.contentChange.emit({\n              editor: this.instance,\n              html: (html === '<p><br></p>') ? null : html,\n              text: this.instance.getText(),\n              delta: delta,\n              oldDelta: oldDelta,\n              source: source\n            });\n          }\n        });\n      });\n\n      // Add handling of blur / focus and selection events\n\n      this.instance.on('selection-change', (range: any, oldRange: any, source: string) => {\n        let resetToolbar = false;\n\n        if (!range && this.hasFocus) {\n          this.hasFocus = false;\n\n          this.blur.emit(this.instance);\n\n          if (this.autoToolbar && this.showToolbar) {\n            this.showToolbar = false;\n          }\n        } else if (range && !this.hasFocus) {\n          this.hasFocus = true;\n\n          this.focus.emit(this.instance);\n\n          // Check if reset is needed to update toolbar\n\n          if (this.autoToolbar && !this.showToolbar) {\n            resetToolbar = true;\n\n            this.showToolbar = true;\n          }\n        } else {\n          this.zone.runOutsideAngular(() => {\n            if (this.instance && this.selectionChange.observers.length) {\n              this.selectionChange.emit({\n                editor: this.instance,\n                range: range,\n                oldRange: oldRange,\n                source: source\n              });\n            }\n          });\n        }\n\n        if (resetToolbar) {\n          setTimeout(() => {\n            this.ngOnDestroy();\n\n            this.ngOnInit();\n          }, 0);\n        }\n      });\n    }\n\n    if (!this.configDiff) {\n      this.configDiff = this.differs.find(this.config || {}).create();\n\n      this.configDiff.diff(this.config || {});\n    }\n  }\n\n  ngOnDestroy(): void {\n    if (this.instance) {\n      const toolbar = this.instance.getModule('toolbar');\n\n      this.selection = this.instance.getSelection();\n\n      if (typeof HTMLElement !== 'undefined' &&\n          toolbar && toolbar.options && toolbar.container &&\n        !(toolbar.options.container instanceof HTMLElement))\n      {\n        toolbar.container.remove();\n      }\n\n      if (this.elementRef && this.elementRef.nativeElement) {\n        const preview = this.elementRef.nativeElement.querySelector('.ql-preview');\n\n        if (preview) {\n          preview.innerHTML = '';\n        }\n      }\n\n      delete this.instance;\n\n      this.instance = null;\n    }\n  }\n\n  ngDoCheck(): void {\n    if (this.configDiff) {\n      const changes = this.configDiff.diff(this.config || {});\n\n      if (changes) {\n        this.ngOnDestroy();\n\n        this.ngOnInit();\n      }\n    }\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    if (this.instance && changes['disabled']) {\n      if (changes['disabled'].currentValue !== changes['disabled'].previousValue) {\n        this.zone.runOutsideAngular(() => {\n          this.ngOnDestroy();\n\n          this.ngOnInit();\n        });\n      }\n    }\n  }\n\n  public quill(): QuillInstance | null {\n    return this.instance;\n  }\n\n  public clear(source?: QuillSources): void {\n    if (this.instance) {\n      this.instance.deleteText(0, this.instance.getLength(), source);\n    }\n  }\n\n  public getValue(): string | undefined {\n    if (this.instance) {\n      return this.instance.getText();\n    }\n  }\n\n  public setValue(value: string, source?: QuillSources): void {\n    if (this.instance) {\n      this.clear(source);\n\n      this.instance.clipboard.dangerouslyPasteHTML(value, source);\n\n      this.instance.setSelection(this.instance.getLength(), 1);\n    }\n  }\n}\n"]}